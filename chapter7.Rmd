--- 
title_meta  : Chapter 7
title       : Graphics
description : R is known for its great graphical capabilities. This chapter familiarizes you with the basic functions to create plots in R. You'll also learn how to customize these plots and how to combine plots.
attachments : 
  slides_link: https://s3.amazonaws.com/assets.datacamp.com/course/introduction_to_r/slides/ch7_slides.pdf

--- type:VideoExercise xp:50
## Basic Graphics

*** =video_link
```{r,eval=FALSE}
//player.vimeo.com/video/138174024
```

*** =video_stream
```{r,eval=FALSE}
https://player.vimeo.com/external/138174024.hd.mp4?s=734830b880a47e7cd6ec947f9de9a4e4&profile_id=119
```

*** =video_hls
```{r,eval=FALSE}
https://player.vimeo.com/external/138174024.m3u8?p=high,standard,mobile&s=120262a983107c7eeb7c48a38f11c7e8
```

*** =skills
1

--- type:NormalExercise xp:100
## Plotting factors

To create basic visualizations in R, a great place to start is the [`plot()`](http://www.rdocumentation.org/packages/graphics/functions/plot) function. This function is very generic, as the graphs it creates are different depending on the type of input information. 

If you try to plot factors, for example, [`plot()`](http://www.rdocumentation.org/packages/graphics/functions/plot) will automagically create a bar chart that nicely displays the number of occurences of each factor. 

You can also pass [`plot()`](http://www.rdocumentation.org/packages/graphics/functions/plot) vectors; the data corresponding to the first argument is then shown on the horizontal x-axis, while the second vector will be plotted on the y-axis.

In this and the following exercises, you'll be working with the `movies` data frame (Source: [OMDb API](http://www.omdbapi.com/)). It contains around 600 movies of four different genres, together with their release year, the [IMDb](http://www.imdb.com/) score and number of votes. `movies` is already available in the workspace. 

*** =instructions
- Use the [`str()`](http://www.rdocumentation.org/packages/utils/functions/str) function to show the structure of `movies`. Can you tell which types of data are in there?
- Plot the `genre` column of `movies`. What does this plot tell you?
- Plot the `genre` column of `movies` (horizontal axis) against the `rating` variable (vertical axis). What do you see?

*** =hint
You'll have to use [`plot()`](http://www.rdocumentation.org/packages/graphics/functions/plot) twice; once with a single argument, and once with two arguments. To select a column from a data frame, you can use `$`: `my_df$my_column`.

*** =pre_exercise_code
```{r, eval=FALSE}
movies <- read.csv("http://s3.amazonaws.com/assets.datacamp.com/course/introduction_to_r/movies.csv", header = TRUE, stringsAsFactors = FALSE)
movies$genre <- factor(movies$genre)
```

*** =sample_code
```{r, eval=FALSE}
# movies is already pre-loaded

# Display the structure of movies


# Plot the genre variable of movies


# Plot the genre variable against the rating variable

```

*** =solution
```{r, eval=FALSE}
# movies is already pre-loaded

# Display the structure of movies
str(movies)

# Plot the genre variable of movies
plot(movies$genre)

# Plot the genre variable against the rating variable
plot(movies$genre, movies$rating)
```

*** =sct
```{r, eval=FALSE}
test_error()
msg <- "Do not overwrite the <code>movies</code> data frame; it has already been created for you!"
test_object("movies", undefined_msg = msg, incorrect_msg = msg)

test_output_contains("str(movies)", incorrect_msg = "Start with displaying the structure of the <code>movies</code> data frame.")

test_function("plot", "x", index = 1, 
              not_called_msg = "Make sure to use the <code>plot()</code> function with a single argument for the first instruction!",
              incorrect_msg = "Have you passed the correct data to the first <code>plot()</code> function? You can use the dollar sign notation to select the <code>genre</code> column.")

test_function("plot", args = c("x","y"), index = 2,
              not_called_msg = "Make sure to use the <code>plot()</code> function with two argument for the second instruction!",
              incorrect_msg = "Have you passed the correct data to the second <code>plot()</code> function? First comes the <code>genre</code>, next the <code>rating</code>.")
success_msg("Great! Use the _Next Plot_ and _Previous Plot_ buttons in the graphical window to inspect the different plots you've created. In the second plot, R realized that you passed a factor for the horizontal axis and a numerical vector for the vertical axis. R created a boxplot of the numerical values, for each category separately. Pretty cool if you ask me!")
```

*** =skills
1

--- type:NormalExercise xp:100
## Plotting numerics

In the previous exercise, you already saw that the combination of a factor and a numeric vector already gave the surprising result of a categorized set of boxplots. But what happens if you pass the [`plot()`](http://www.rdocumentation.org/packages/graphics/functions/plot) function a single numeric vector? And what if you pass two vectors to [`plot()`](http://www.rdocumentation.org/packages/graphics/functions/plot)? No theory on this one, let's simply learn by doing!

You will again be working with the `movies` data frame, which is already available in the workspace.

*** =instructions
- Plot the `runtime` variable of `movies`. Can you tell what's on the horizontal axis and what is on the vertical one?
- Using [`plot()`](http://www.rdocumentation.org/packages/graphics/functions/plot), create a graph that shows the `rating` against `runtime`. `rating` should be on the horizontal x-axis, and `runtime` on the vertical y-axis. Is there a correlation between the two variables?

*** =hint
Again, use the dollar sign notation to select columns from your data frame. Variables on the x-axis come first in [`plot()`](http://www.rdocumentation.org/packages/graphics/functions/plot), those on the y-axis come second.

*** =pre_exercise_code
```{r, eval=FALSE}
movies <- read.csv("http://s3.amazonaws.com/assets.datacamp.com/course/introduction_to_r/movies.csv", header = TRUE, stringsAsFactors = FALSE)
movies$genre <- factor(movies$genre)
```

*** =sample_code
```{r, eval=FALSE}
# movies is already pre-loaded

# Plot the runtime variable of movies


# Plot rating (x) against runtime (y)


```

*** =solution
```{r, eval=FALSE}
# movies is already pre-loaded

# Plot the runtime variable of movies
plot(movies$runtime)

# Plot rating (x) against runtime (y)
plot(movies$rating, movies$runtime)
```

*** =sct
```{r, eval=FALSE}
test_error()
msg <- "Do not overwrite the <code>movies</code> data frame; it has already been created for you!"
test_object("movies", undefined_msg = msg, incorrect_msg = msg)

test_function_v2("plot", "x", index = 1, 
              not_called_msg = "Make sure to use the <code>plot()</code> function with a single argument for the first instruction!",
              incorrect_msg = "Have you passed the correct data to the first <code>plot()</code> function? You can use the dollar sign notation to select the <code>runtime</code> column.")

test_function_v2("plot", args = c("x","y"), index = 2,
              not_called_msg = "Make sure to use the <code>plot()</code> function with two argument for the second instruction!",
              incorrect_msg = "Have you passed the correct data to the second <code>plot()</code> function? First comes <code>rating</code>, next <code>runtime</code>.")

success_msg("Nice! If you use <code>plot()</code> with a single argument, you'll get an index plot, while with two arguments you'll get a classical scatterplot. From the second plot, there seems to be a light correlation between the length of a movie and its rating.")
```

*** =skills
1

--- type:NormalExercise xp:100
## Create a Histogram

Another function that Filip introduced in the video, is [`hist()`](http://www.rdocumentation.org/packages/graphics/functions/hist). Basically, the [`hist()`](http://www.rdocumentation.org/packages/graphics/functions/hist) function visualizes the distribution of your data by placing all values in bins and displaying the bin frequencies of each bin. Have a look at the usage of the [`hist()`](http://www.rdocumentation.org/packages/graphics/functions/hist) function:

```
hist(x, breaks = "Sturges")
```

`x` is the vector of values for which you want to create a histogram. The `breaks` argument specifies how many bins, or histogram cells, your plot should contain. By default, the "Sturges" algorithm is used to automatically determine the number of bins.

This slightly positive correlation has got you thinking about the `rating` variable of the `movies` data frame. Maybe a quick peek at its distribution might help your understanding.

*** =instructions
- Create a histogram of the `rating` variable of `movies`.
- Do the same thing, but this time set the number of bins to 20 with the `breaks` argument.

*** =hint
You have to use [`hist()`](http://www.rdocumentation.org/packages/graphics/functions/hist) twice. Use the dollar sign notation to select the columns from `movies`.

*** =pre_exercise_code
```{r, eval=FALSE}
movies <- read.csv("http://s3.amazonaws.com/assets.datacamp.com/course/introduction_to_r/movies.csv", header = TRUE, stringsAsFactors = FALSE)
movies$genre <- factor(movies$genre)
```

*** =sample_code
```{r, eval=FALSE}
# movies is already pre-loaded

# Create a histogram for rating


# Create a histogram for rating, with 6 bins

```

*** =solution
```{r, eval=FALSE}
# movies is already pre-loaded

# Create a histogram for rating
hist(movies$rating)

# Create a histogram for rating, with 20 bins
hist(movies$rating, breaks = 20)
```

*** =sct
```{r, eval = FALSE}
test_error()
msg <- "Do not overwrite the <code>movies</code> data frame; it has already been created for you!"
test_object("movies", undefined_msg = msg, incorrect_msg = msg)

success_msg("Nice! The histograms give you quite a good idea of the <code>rating</code> variable. Compare both histograms, which one do you find most informative? Whatever your taste: choosing a suitable number of bins is important!")
```

*** =skills
1

--- type:NormalExercise xp:100
## Other graphics functions

Apart from the [`plot()`](http://www.rdocumentation.org/packages/graphics/functions/plot) and [`hist()`](http://www.rdocumentation.org/packages/graphics/functions/hist) function, there are many more easy-to-use and very useful functions in the `graphics` package. You'll experiment with just a few in this exercise. Giving you a full overview would take us too far, but feel free to check out the documentation on the functions if you are interested in learning more. To get more insight into the [`boxplot()`](http://www.rdocumentation.org/packages/graphics/functions/boxplot) function for example, simply type:

```
?boxplot
```

in the console, and an RDocumentation page will pop up!

*** =instructions
- Create a boxplot - a visualzation of the four quartiles of a vector - of the `runtime` variable with the [`boxplot()`](http://www.rdocumentation.org/packages/graphics/functions/boxplot) function.
- It's also possible to plot an entire data frame with [`plot()`](http://www.rdocumentation.org/packages/graphics/functions/plot). Try it out on a subset of the `movies` data frame that only contains the columns `rating`, `votes` and `runtime`. Can you analyze the resulting plot?
- Use the [`table()`](http://www.rdocumentation.org/packages/base/functions/table) function to build a table of counts of the genres in `movies`. Use the resulting table to create a pie chart with [`pie()`](http://www.rdocumentation.org/packages/graphics/functions/pie).

*** =hint
Use `table(movies$genre)` inside the [`pie()`](http://www.rdocumentation.org/packages/graphics/functions/pie) function.

*** =pre_exercise_code
```{r, eval=FALSE}
movies <- read.csv("http://s3.amazonaws.com/assets.datacamp.com/course/introduction_to_r/movies.csv", header = TRUE, stringsAsFactors = FALSE)
movies$genre <- factor(movies$genre)
```

*** =sample_code
```{r, eval=FALSE}
# movies is already pre-loaded

# Create a boxplot of the runtime variable


# Subset the dateframe and plot it entirely


# Create a pie chart of the table of counts of the genres

```

*** =solution
```{r, eval=FALSE}
# movies is already pre-loaded

# Create a boxplot of the runtime variable
boxplot(movies$runtime)

# Subset the dateframe and plot it entirely
plot(movies[,c("rating", "votes", "runtime")] )

# Create a pie chart of the table of counts of the genres
pie(table(movies$genre))
```

*** =sct
```{r, eval=FALSE}
test_error()
msg <- "Do not overwrite the <code>movies</code> data frame; it has already been created for you!"
test_object("movies", undefined_msg = msg, incorrect_msg = msg)

test_function("boxplot", "x",
              incorrect_msg = paste("Have you correctly possed the <code>runtime</code> variable of",
                                    "<code>movies</code> to the <code>boxplot()</code> function?"))

test_function("plot", "x", 
              incorrect_msg = paste("Have you passed the correct data frame to the <code>plot()</code> function?",
                                    "Make sure that it's an entire data frame, containing the three columns in the listed order!"))

test_function("pie", "x", 
              incorrect_msg = paste("Have you created a table of genre counts and subsequently",
                                    "passed it to the <code>pie()</code> function? Try again."))

success_msg("Perfect! Know that there are many more functions to create the plots that you need in R!")
```

*** =skills
1

--- type:ChallengeExercise xp:200
## How does your salary compare?
For your first visualization challenge, a new data set is available in the workspace: `salaries`. It contains the gross hourly salary in US Dollars (`salary`), according to your eduction (`degree`: 1 = did not finish high school, 2= Finished high school, 3= Higher Education) and experience in years (`experience`) of 65 different people. 

Suppose that you have a higher degree and are currently working as a data scientist at 100 dollar an hour. It could be interesting to see how your salary compares to other people who have finished their higher education! Combine your knowledge of data frame subsetting and plotting, and you'll solve this one in no time!

*** =challenge_steps
## Subsetting your dataframe
First things first: as you want to compare people who have the same level of education as you do, you have to start by making a subset of your dataframe that only includes people with a higher education degree. You can subset from the `salaries` dataframe using square brackets. Store the new dataframe in `salaries_educ`.

## Making a histogram
To get a good overview of the distibution in your education class, you can use the [`hist()`](http://www.rdocumentation.org/packages/graphics/functions/hist) function.

## Look at the histogram in more detail
Finally you want to tailor your histogram some more. You can tell R to use a specific number of bins with the `breaks` argument; set it to 10. Again use the [`hist()`](http://www.rdocumentation.org/packages/graphics/functions/hist) function.

*** =challenge_goal
## How much money do you make?!
In this challenge, you want to get a good overview of what your salary is worth within your education class. First subset the `salaries` data frame such that it only contains observations with a `degree` of 3. Call this data frame `salaries_educ`. Next, build a histogram of the `salary` column of `salaries_educ`. In order to get a histogram that's specific enough, use 10 bins.

*** =pre_exercise_code
```{r eval=FALSE}
salaries<-read.table("http://s3.amazonaws.com/assets.datacamp.com/course/introduction_to_r/salaries.txt",header=T)
salaries<-salaries[,-4]
```

*** =solution
```{r eval=FALSE}
salaries_educ <- salaries[salaries$degree == 3, ]
hist(salaries_educ$salary, breaks = 10)
```

*** =sct
```{r eval=FALSE}
test_instruction(1, {
  test_error()
  test_object("salaries_educ")
})
test_instruction(2, {
  test_error()
  test_function("hist","x")
})
test_instruction(3, {
  test_error()
  test_function("hist",c("x","breaks"))
})
test_instruction(4, {
  test_error()
  test_function("hist",c("x","breaks"))
})
success_msg("Great! As you can see, there aren't that many people that make more than 100$, so you are right there among the top of your education class!")
```

*** =skills
1

--- type:VideoExercise xp:50
## Customizing Plots

*** =video_link
```{r,eval=FALSE}
//player.vimeo.com/video/138174037
```

*** =video_stream
```{r,eval=FALSE}
https://player.vimeo.com/external/138174037.hd.mp4?s=5c7a41a07567150c8aebdbb78b89c071&profile_id=119
```

*** =video_hls
```{r,eval=FALSE}
https://player.vimeo.com/external/138174037.m3u8?p=high,standard,mobile&s=7d2b41f7bad7599feccf26780f171518
```

*** =skills
1

--- type:NormalExercise xp:100
## Title and axis labels

When you use the [`plot()`](http://www.rdocumentation.org/packages/graphics/functions/plot) function by simply passing it the data you want to plot, you'll end up with a plot that is not very nice to look at. To make your plot more interpretable, a clear plot title as well as well-chosen axis labels are very important. You can use the arguments `main`, `xlab` and `ylab` for this. To add a subtitle to your plot, use `sub`.

In this and the following exercises, you'll be working with the `movies` data frame again.  It contains around 600 movies of four different genres, together with their release year, the [IMDb](http://www.imdb.com/) score and number of votes. `movies` is already available in the workspace.

*** =instructions
Create a plot that has the following properties:
- It plots the variables `votes` (x-axis) against `runtime` (y-axis);
- The title of the plot is "Votes versus Runtime" (R is senstive to capitalization!);
- The x-axis and y-axis are labeled "Number of votes [-]" and "Runtime [s]" respectively;
- The subtitle of the plot is "No clear correlation".

*** =hint
To create the correct plot, start from `plot(movies$votes, movies$runtime)`.

*** =pre_exercise_code
```{r, eval=FALSE}
movies <- read.csv("http://s3.amazonaws.com/assets.datacamp.com/course/introduction_to_r/movies.csv", 
                   header = TRUE, stringsAsFactors = FALSE)
movies$genre <- factor(movies$genre)
```

*** =sample_code
```{r, eval=FALSE}
# movies is pre-loaded in your workspace

# Create a customized plot
```

*** =solution
```{r, eval=FALSE}
# movies is pre-loaded in your workspace

# Create a customized plot
plot(movies$votes, movies$runtime,
     main = "Votes versus Runtime",
     xlab = "Number of votes [-]",
     ylab = "Runtime [s]",
     sub = "No clear correlation")
```

*** =sct
```{r, eval=FALSE}
test_error()
msg <- "Do not overwrite the <code>movies</code> data frame; it has already been created for you!"
test_object("movies", undefined_msg = msg, incorrect_msg = msg)

test_function("plot", "x")
test_function("plot", "y")
test_function("plot", "main")
test_function("plot", "xlab")
test_function("plot", "ylab")
test_function("plot", "sub")
test_function("plot", c("x","y","main","xlab","ylab","sub"))

success_msg("That's already much better, but there's more you can do!")
```

*** =skills
1

--- type:NormalExercise xp:100
## Colors and shapes

By default, R prints rather dark colors: scatter plots have dots, axis, labels and titles that are all black. Histograms have a grayish fill if you do not manually specify the options. 

But the times of dull plots are officially over. Now you can color your plot any way you want it with the `col` and related `col.*` arguments. You can also change the dots to different plot symbols with `pch`. For more details, check out the comprehensive list of graphical parameters in the documentation of [`par()`](http://www.rdocumentation.org/packages/graphics/functions/par):

```
?par
```

If you want to specify colors, you can choose simple strings such as "red" and "blue", but also you can also use [indices](http://research.stowers-institute.org/efg/R/Color/Chart/index.htm) and [hexadecimal codes](http://www.color-hex.com/). For example, `col = 1`, `col = "white"`, and `col = "#FFFFFF"` are all equivalent. 

*** =instructions
Customize the plot from the previous exercise even further:
- Choose the plot symbol that corresponds to an index `9`. What does it look like?
- Change the color of these new plot symbols to be `"#dd2d2d"`.
- Set the color of the main title to `604`.

*** =hint
You can simply extend the plot argument with the arguments `pch`, `col` and `col.main` respectively.

*** =pre_exercise_code
```{r, eval=FALSE}
movies <- read.csv("http://s3.amazonaws.com/assets.datacamp.com/course/introduction_to_r/movies.csv", header = TRUE, stringsAsFactors = FALSE)
movies$genre <- factor(movies$genre)
```

*** =sample_code
```{r, eval=FALSE}
# movies is pre-loaded in your workspace

# Customize the plot further
plot(movies$votes, movies$runtime,
     main = "Votes versus Runtime",
     xlab = "Number of votes [-]",
     ylab = "Runtime [s]",
     sub = "No clear correlation")
```

*** =solution
```{r, eval=FALSE}
# movies is pre-loaded in your workspace

# Customize the plot further
plot(movies$votes, movies$runtime,
     main = "Votes versus Runtime",
     xlab = "Number of votes [-]",
     ylab = "Runtime [s]",
     sub = "No clear correlation",
     pch = 9,
     col = "#dd2d2d",
     col.main = 604)
```

*** =sct
```{r, eval=FALSE}
test_error()
msg <- "Do not overwrite the <code>movies</code> data frame; it has already been created for you!"
test_object("movies", undefined_msg = msg, incorrect_msg = msg)

test_function("plot", c("x","y","main","xlab","ylab","sub"))
test_function("plot", "pch")
test_function("plot", "col")
test_function("plot", "col.main")
test_function("plot", c("x","y","main","xlab","ylab","sub","pch","col","col.main"))

success_msg("Great! Can you still remember the basic plot, without titles or labels and simple black dots? What a difference!")
```

*** =skills
1

--- type:NormalExercise xp:100
## Customize Everything!

The last argument that Filip talked about was the `cex` argument and the other related `cex.*` arguments. With `cex.axis` for example, you can specify how much the font of the axis ticks should be made smaller or larger with respect to the general font size. You can do similar things with `cex.main` and `cex.lab`.

Time to combine all this knowledge to build one ridiculously customized plot!

*** =instructions
Customize the plot that has been coded on the right:
- The title is "Are recent movies voted more on?".
- The x-axis is labeled "Number of votes [-]", the y-axis is labeled "Year [-]".
- The scatter plot contains orange points with symbol index 19.
- The size of the axis ticks' font size is 80% of the overall font size.

*** =hint
- You'll need the arguments `main`, `xlab`, `ylab`, `col`, `cex.axis` and `pch`.
- `cex.axis` equal to 0.8 means that the font size of the labels will be 80% of that of the overall font size of the plot.

*** =pre_exercise_code
```{r, eval=FALSE}
movies <- read.csv("http://s3.amazonaws.com/assets.datacamp.com/course/introduction_to_r/movies.csv", header = TRUE, stringsAsFactors = FALSE)
movies$genre <- factor(movies$genre)
```

*** =sample_code
```{r, eval=FALSE}
# movies is pre-loaded in your workspace

# Customize the plot further
plot(movies$votes, movies$year)
```

*** =solution
```{r, eval=FALSE}
# movies is pre-loaded in your workspace

# Customize the plot further
plot(movies$votes, movies$year,
     main = "Are recent movies voted more on?",
     xlab = "Number of votes [-]",
     ylab = "Year [-]",
     col = "orange",
     cex.axis = 0.8,
     pch = 19)
```

*** =sct
```{r, eval=FALSE}
test_error()
msg <- "Do not overwrite the <code>movies</code> data frame; it has already been created for you!"
test_object("movies", undefined_msg = msg, incorrect_msg = msg)

test_function("plot", c("x","y"))
test_function("plot", "main")
test_function("plot", "xlab")
test_function("plot", "ylab")
test_function("plot", "col")
test_function("plot", "pch")
test_function("plot", "cex.axis")
test_function("plot", c("x","y","main","xlab","ylab","col","pch","cex.axis"))

success_msg("Cool! It seems that indeed more recent movies have gotten more votes overall. This makes perfect sense because there wasn't anything like IMDb in the seventies..")
```

*** =skills
1

--- type:NormalExercise xp:100
## Customizing Histograms

Apart from specifying how many bins a histogram should contain, there are many other things you can specify. On the one hand, there are bin calculation related arguments, but there are also options to make your histogram better looking, like you did before with [`plot()`](http://www.rdocumentation.org/packages/graphics/functions/plot).

If you check out the documentation of [`hist()`](http://www.rdocumentation.org/packages/graphics/functions/hist), you'll again find an entire list of arguments. The `...` in there again refers to the graphical parameters that can be set to change the way your histogram looks. Let's experiment with some different parameters and see how far you get! If you're not sure which argument to use, simply call for its documentation using `?hist`.

*** =instructions
Create a histogram of the `runtime` of all the observations in the `movies` data frame:
- Set the number of bins to 20.
- Set the limits of the x-axis to `c(90, 220)`
- The histogram is titled "Distribution of Runtime".
- The x-axis is labeled "Runtime [-]".
- The fill of the bars is "cyan" (`col` argument).
- The color of the bars' borders are "red" (`border` argument).

*** =hint
- To set the limits of the x-axis, you have to specify the `xlim` arguments. The histogram's title can be set with `main` as before. Also `xlab` can be used again to change the name of the x-axis.

*** =pre_exercise_code
```{r, eval=FALSE}
movies <- read.csv("http://s3.amazonaws.com/assets.datacamp.com/course/introduction_to_r/movies.csv", header = TRUE, stringsAsFactors = FALSE)
movies$genre <- factor(movies$genre)
```

*** =sample_code
```{r, eval=FALSE}
# movies is pre-loaded in your workspace

# Build a customized histogram

```

*** =solution
```{r, eval=FALSE}
# movies is pre-loaded in your workspace

# Build a customized histogram
hist(movies$runtime,
     breaks = 20,
     xlim = c(90, 220),
     main = "Distribution of Runtime",
     xlab = "Runtime [-]",
     col = "cyan",
     border = "red")
```

*** =sct
```{r, eval=FALSE}
test_error()
msg <- "Do not overwrite the <code>movies</code> data frame; it has already been created for you!"
test_object("movies", undefined_msg = msg, incorrect_msg = msg)

test_function("hist", "x")
test_function("hist", "breaks")
test_function("hist", "xlim")
test_function("plot", "main")
test_function("plot", "xlab")
test_function("plot", "col")
test_function("plot", "border")
test_function("plot", c("x","breaks", "xlim", "main", "xlab", "col", "border"))

success_msg("Nice! Can you see how a change of any of the arguments affects the histogram? Feel free to experiment some more before you head over to the challenge!")
```

*** =skills
1

--- type:ChallengeExercise xp:200
## Does work experience influence your salary?
Remember how you tried to figure out if you were making enough money based on your education? Well, in this challenge you will work with the same dataset, but this time you want to figure out whether experience has an important role in determining someone's salary. This data is however no longer available in the `salaries` dataframe, but in the vector `exp`. You will have to add it back into the dataframe `salaries`. 

As before you are only interested in people with the same level of education as you. After you have worked hard preparing your dataframe, you will get to make a very fancy plot, in order to find out about the effect of experience on salary. Curious about the result?

*** =challenge_steps
## Merge your data
In the first step, it is recommended to add the `experience` vector to the dataframe `salaries`. You can do this by making use of the dollar sign or square brackets.

## Subset your data
Next, just as in the previous challenge, you want to only keep the observations which have a `degree` equal to 3. You can subset the `salaries` dataframe using square brackets. Store the new dataframe in `salaries_educ`.

## Fancy plotting, level: expert
Time to build an awesome plot:
- Set the title to "Does experience matter?" with the `main` argument.
- x-axis and y-axis are labelled "Work experience" and "Salary" respectively (use `xlab` and `ylab`).
- Set the color of your plot to "blue" (`col`) and the title color to "red" (`col.main`).
- The axis ticks' font size should 120% the overall font size (`cex.axis`).

*** =challenge_goal
## Plot the relation between salary and experience
Extend the `salaries` data frame, by adding the `exp` vector as a new column, `experience`. Next, build a new data frame `salaries_educ`, that contains only the observations for people who did a higher education (`degree = 3`).
Next, make a plot of the `salary` (y-axis) and `experience` (x-axis) columns of `salaries_educ` with the following properties:
- The plot is titled "Does experience matter?".
- The x-axis and y-axis are labelled "Work experience" and "Salary", respectively.
- Then make the color of your plot symbols (`col`) blue and the color of your title (`col.main`) red.
- The axis ticks' font size is 120% of the overall font size (`cex.axis`).

*** =pre_exercise_code
```{r eval=FALSE}
salaries <- read.table("http://s3.amazonaws.com/assets.datacamp.com/course/introduction_to_r/salaries.txt", header = TRUE)
exp <- salaries$experience
salaries <- salaries[,-c(3,4)]
```

*** =solution
```{r eval=FALSE}
salaries$experience <- exp
salaries_educ <- salaries[salaries$degree == 3, ]
plot(salaries_educ$experience, salaries_educ$salary, 
     main = "Does experience matter?" ,
     xlab = "Work experience",
     ylab = "Salary",
     col = "blue",
     col.main = "red",
     cex.axis = 1.2)
```

*** =sct
```{r eval=FALSE}
test_instruction(1, {
  test_error()
  test_object("salaries")
})
test_instruction(2, {
  test_error()
  test_object("salaries_educ")
})
test_instruction(3, {
  test_error()
  test_function("plot", c("x","main", "xlab", "ylab", "cex.axis"))
})
test_instruction(4, {
  test_error()
  test_object("salaries_educ")
  test_function("plot", c("x","main", "xlab", "ylab", "cex.axis"))
})
success_msg("Great work! You are now able to play around with plots in R! You clearly see a positive correlation between work experience and salary, right? It's time for the final part of this introductory course! Let's finish this thing!")
```

*** =skills
1

--- type:VideoExercise xp:50
## Multiple Plots

*** =video_link
```{r,eval=FALSE}
//player.vimeo.com/video/138174049
```

*** =video_stream
```{r,eval=FALSE}
https://player.vimeo.com/external/138174049.hd.mp4?s=7d6009c52ac0fd2552108c337e48061e&profile_id=119
```

*** =video_hls
```{r,eval=FALSE}
https://player.vimeo.com/external/138174049.m3u8?p=high,standard,mobile&s=aa1672c0b88109eb9a4e9d3805c10c4b
```

*** =skills
1


--- type:NormalExercise xp:100
## Multiple plots with par()

In publications or reports, it's often a good idea to combine different plots; this saves space but also allows readers to easily compare the plots. As Filip explained in the instructional video, you can use the [`par()`](http://www.rdocumentation.org/packages/graphics/functions/par) function to specify the `mfrow` argument. If you for example execute

```
par(mfrow = c(1,2))
```

and next build two plots, these will appear next to each other in the same figure. `c(1,2)` corresponds to a grid of 1 row and 2 columns.

You'll continue working with the `movies` data frame. It contains around 600 movies of four different genres, together with their release year, the [IMDb](http://www.imdb.com/) score and number of votes. `movies` is already available in the workspace.

*** =instructions
- List all the graphical parameters that are currently active in your session, by running [`par()`](http://www.rdocumentation.org/packages/graphics/functions/par).
- Next, use [`par()`](http://www.rdocumentation.org/packages/graphics/functions/par) to set the `mfrow` parameter: R should plot figures on a 2-by-1 grid (2 rows, 1 column).
- Build two plots:
  + A scatterplot that plots the `votes` (x-axis) against the `rating` (y-axis) variable of `movies`.
  + A histogram of the `votes` variable

*** =hint
- You should use [`par()`](http://www.rdocumentation.org/packages/graphics/functions/par) twice: once to list all the graphical parameters; once to specify the grid.

*** =pre_exercise_code
```{r, eval=FALSE}
movies <- read.csv("http://s3.amazonaws.com/assets.datacamp.com/course/introduction_to_r/movies.csv", header = TRUE, stringsAsFactors = FALSE)
movies$genre <- factor(movies$genre)
par(mfrow = c(1,1))
```

*** =sample_code
```{r, eval=FALSE}
# movies is pre-loaded in your workspace

# List all the graphical parameters


# Specify the mfrow parameter


# Build two plots



```

*** =solution
```{r, eval=FALSE}
# movies is pre-loaded in your workspace

# List all the graphical parameters
par()

# Specify the mfrow parameter
par(mfrow = c(2,1))

# Build two plots
plot(movies$votes, movies$rating)
hist(movies$votes)
```

*** =sct
```{r, eval=FALSE}
test_error()
msg <- "Do not overwrite the <code>movies</code> data frame; it has already been created for you!"
test_object("movies", undefined_msg = msg, incorrect_msg = msg)

test_function("par")
test_function("par", "mfrow")
test_function("plot", c("x","y"))
test_function("hist", "x")
success_msg("Nice! Notice how your plots appear in a vertical arrangement: the plot that you generated first, comes on top.")
```

*** =skills
1

--- type:NormalExercise xp:100
## Complex layouts!

The `mfrow` and `mfcol` functions work perfectly if you want to place your different subplots on a rectangular grid. But it's still a grid. With the [`layout()`](http://www.rdocumentation.org/packages/graphics/functions/layout) function, you can define more complex plot arrangements. In its most minimal use, [`layout()`](http://www.rdocumentation.org/packages/graphics/functions/layout) simply requires a matrix, that defines where each plot should be placed.

In this exercise, you're going to define a layout with three figures. The first figure appears top left, the second one bottom left. The third figure should appear on the right and span the entire height of the layout.

*** =instructions
- Build a 2-by-2 matrix, `grid`, that will be used for positioning the 3 subplots as specified above.
- Use [`layout()`](http://www.rdocumentation.org/packages/graphics/functions/layout) in combination with `grid`.
- Build three plots for the `movies` data frame (in this order):
  + A scatter plot of `rating` (x-axis) versus `runtime` (y-axis).
  + A scatter plot of `votes` (x-axis) versus `runtime` (y-axis).
  + A boxplot of the `runtime` (use [`boxplot()`](http://www.rdocumentation.org/packages/graphics/functions/boxplot))

*** =hint
- Passing the vector `c(1,2,3,3)` to [`matrix()`](http://www.rdocumentation.org/packages/base/functions/matrix) while setting `nrow = 2` suffices to build the correct matrix.

*** =pre_exercise_code
```{r, eval=FALSE}
movies <- read.csv("http://s3.amazonaws.com/assets.datacamp.com/course/introduction_to_r/movies.csv", header = TRUE, stringsAsFactors = FALSE)
movies$genre <- factor(movies$genre)
par(mfrow = c(1,1))
```

*** =sample_code
```{r, eval=FALSE}
# movies is pre-loaded in your workspace

# Build the grid matrix


# Specify the layout


# Build three plots


```

*** =solution
```{r, eval=FALSE}
# movies is pre-loaded in your workspace

# Build the grid matrix
grid <- matrix(c(1, 2, 3, 3), nrow = 2)

# Specify the layout
layout(grid)

# Build three plots
plot(movies$rating, movies$runtime)
plot(movies$votes, movies$runtime)
boxplot(movies$runtime)
```

*** =sct
```{r, eval=FALSE}
test_error()
msg <- "Do not overwrite the <code>movies</code> data frame; it has already been created for you!"
test_object("movies", undefined_msg = msg, incorrect_msg = msg)

test_object("grid")
test_function("layout")
test_function_v2("plot", c("x","y"), index = 1)
test_function_v2("plot", c("x","y"), index = 2)
test_function("boxplot", "x")
success_msg("Great! Feel free to experiment some more with the <code>layout()</code> function. It's great way of building very insightful plots.")
```

*** =skills
1

--- type:NormalExercise xp:100
## Complex layouts with customized plots

Being able to place different subplots in fancy arrangements with [`layout()`](http://www.rdocumentation.org/packages/graphics/functions/layout) is a great tool to pimp your reports and publications, but of course you shouldn't forget about the plot customization you learned about before. `xlab`, `ylab`, `main`, `pch`, you name it: they can all facilitate a better understanding of the message you're trying to convey with your figures!

The sample code on the right contains a model solution to the previous exercise: up to you to customize the plots some more. Stick to specifying the graphical parameters inside the actual plot functions; do not use [`par()`](http://www.rdocumentation.org/packages/graphics/functions/par).

*** =instructions
Customize the plots that are already coded on the right:
- The first plot: axis labels are "Rating" and "Runtime"; use plot symbol 4.
- The second plot: axis labels are "Number of Votes" and "Runtime"; plot color is "blue".
- Third plot: Set the border of the boxplot to `"darkgray"` through the `border` argument (`"darkgrey"` also works, but use `"darkgray"`); main title is "Boxplot of Runtime".
Feel free to customize these plots even further!

*** =hint
- For the plot symbol, use `pch`. 
- For the plot color, use `col`.

*** =pre_exercise_code
```{r, eval=FALSE}
movies <- read.csv("http://s3.amazonaws.com/assets.datacamp.com/course/introduction_to_r/movies.csv", header = TRUE, stringsAsFactors = FALSE)
movies$genre <- factor(movies$genre)
par(mfrow = c(1,1))
```

*** =sample_code
```{r, eval=FALSE}
# movies is pre-loaded in your workspace

# Build the grid matrix
grid <- matrix(c(1, 2, 3, 3), nrow = 2)

# Specify the layout
layout(grid)

# Customize the three plots
plot(movies$rating, movies$runtime)
plot(movies$votes, movies$runtime)
boxplot(movies$runtime)
```

*** =solution
```{r, eval=FALSE}
# movies is pre-loaded in your workspace

# Build the grid matrix
grid <- matrix(c(1, 2, 3, 3), nrow = 2)

# Specify the layout
layout(grid)

# Customize the three plots
plot(movies$rating, movies$runtime, xlab = "Rating", ylab = "Runtime", pch = 4)
plot(movies$votes, movies$runtime, xlab = "Number of Votes", ylab = "Runtime", col = "blue")
boxplot(movies$runtime, main = "Boxplot of Runtime", border = "darkgray")
```

*** =sct
```{r, eval=FALSE}
test_error()
msg <- "Do not overwrite the <code>movies</code> data frame; it has already been created for you!"
test_object("movies", undefined_msg = msg, incorrect_msg = msg)

test_object("grid")
test_function("layout")
test_function_v2("plot", c("x","y"), index = 1)
test_function_v2("plot", c("xlab"), index = 1)
test_function_v2("plot", c("ylab"), index = 1)
test_function_v2("plot", c("pch"), index = 1)
test_function_v2("plot", c("x", "y", "xlab", "ylab", "pch"), index = 1)

test_function_v2("plot", c("x","y"), index = 2)
test_function_v2("plot", c("xlab"), index = 2)
test_function_v2("plot", c("ylab"), index = 2)
test_function_v2("plot", c("col"), index = 2)
test_function_v2("plot", c("x", "y", "xlab", "ylab", "col"), index = 2)

test_function("boxplot", "x")
test_function("boxplot", "main")
test_function("boxplot", "border")
test_function("boxplot", c("x","main","border"))

success_msg("Nice! Instead of having very interpretable, clean plots, the different colors actually made a mess of it. Remember that interpretability is the holy grail when you're building visualizations!")
```

*** =skills
1

--- type:NormalExercise xp:100
## Plot a linear regression

Next to creating different plot arrangements with `mfrow`, `mfcol` or with the [`layout()`](http://www.rdocumentation.org/packages/graphics/functions/layout) function, the video also talked about adding layers to your plots. There are functions such as [`plot()`](http://www.rdocumentation.org/packages/graphics/functions/plot) and [`hist()`](http://www.rdocumentation.org/packages/graphics/functions/hist) that build new figures, but there are also functions such as [`abline()`](http://www.rdocumentation.org/packages/graphics/functions/abline), [`text()`](http://www.rdocumentation.org/packages/graphics/functions/text), [`lines()`](http://www.rdocumentation.org/packages/graphics/functions/lines), [`segments()`](http://www.rdocumentation.org/packages/graphics/functions/segments). These functions add graphical elements to the current figure, instead of creating a new figure. These are great to add more information to your plots.

In this exercise, you will try to model the rating of a movie based on the number of votes it received. Maybe movies that have been voted on often have higher rates than movies that received less votes? Or is it the other way around? `movies` is already preloaded in the workspace.

*** =instructions
- Fit a linear regression that models `rating` based on `votes`. Use the function [`lm()`](http://www.rdocumentation.org/packages/stats/functions/lm) with `movies$rating ~ movies$votes` as the only argument. Assign the result to `movies_lm`.
- Build a scatterplot with `votes` on the x-axis and `rating` on th y-axis.
- Add a straight line to this plot with [`abline()`](http://www.rdocumentation.org/packages/graphics/functions/abline). You have to pass the coefficients of `movies_lm` to it. You can use [`coef()`](http://www.rdocumentation.org/packages/stats/functions/coef) to extract these coefficients.

*** =hint
- To plot the straight line, use `abline(coef(movies_lm))`.

*** =pre_exercise_code
```{r, eval=FALSE}
movies <- read.csv("http://s3.amazonaws.com/assets.datacamp.com/course/introduction_to_r/movies.csv", header = TRUE, stringsAsFactors = FALSE)
movies$genre <- factor(movies$genre)
par(mfrow = c(1,1))
```

*** =sample_code
```{r, eval=FALSE}
# movies is pre-loaded in your workspace

# Fit a linear regression: movies_lm


# Build a scatterplot: rating versus votes


# Add straight line to scatterplot

```

*** =solution
```{r, eval=FALSE}
# movies is pre-loaded in your workspace

# Fit a linear regression: movies_lm
movies_lm <- lm(movies$rating ~ movies$votes)

# Build a scatterplot: rating versus votes
plot(movies$votes, movies$rating)

# Add straight line to scatterplot
abline(coef(movies_lm))
```

*** =sct
```{r, eval=FALSE}
test_error()
msg <- "Do not overwrite the <code>movies</code> data frame; it has already been created for you!"
test_object("movies", undefined_msg = msg, incorrect_msg = msg)

test_data_frame("movies_lm", "coefficients", 
                undefined_msg = "Have you defined <code>movies_lm</code>?", 
                undefined_cols_msg = paste0("There should be a <code>coefficients</code> element in",
                                            " the <code>movies_lm</code> model, but it wasn't found. Try again."),
                incorrect_msg = "There's something wrong with the linear model you coded. Simply use <code>lm(movies$rating ~ movies$votes)</code>")
test_function("plot", c("x","y"))
test_function("coef")
test_function("abline")
success_msg("Great! There seems to be a positive correlation between the number of votes a movie received and its rating. Head over to the next exercise to customize these plots some more!")
```

*** =skills
1

--- type:NormalExercise xp:100
## Customize your linear regression plot

The scatter plot with an overlayed linear regression line that you built in the previous figure is a great start. But again, some customizations here and there wouldn't hurt right? And what about some text in your plot that gives some more information?

A model solution for the previous exercise has already been coded on the right. Up to you to extend it and enter the visualization hall of fame with your slick plot!

*** =instructions
- Edit the scatterplot:
  + The plot title is "Analysis of IMDb data"
  + The x-axis should be labeled "Number of Votes"
  + The y-axis has the title "Rating"
  + Use a "darkorange" color and plot symbol number 15
  + Set `cex` to 0.7.
- Edit the [`abline()`](http://www.rdocumentation.org/packages/graphics/functions/abline) function:
  + Line width of the straight line is 2.
  + Color of the line is "red"
- Add [`text()`](http://www.rdocumentation.org/packages/graphics/functions/text) to the plot. Use the predefined variables `xco` and `yco` as first arguments, and set the `label` inside [`text()`](http://www.rdocumentation.org/packages/graphics/functions/text) to "More votes? Higher rating!".

*** =hint
- Among the usual arguments, you'll need `col`, `pch` and `cex` in [`plot()`](http://www.rdocumentation.org/packages/graphics/functions/plot). Inside [`abline()`](http://www.rdocumentation.org/packages/graphics/functions/abline), `lwd` and `col` will do the trick.

*** =pre_exercise_code
```{r, eval=FALSE}
movies <- read.csv("http://s3.amazonaws.com/assets.datacamp.com/course/introduction_to_r/movies.csv", header = TRUE, stringsAsFactors = FALSE)
movies$genre <- factor(movies$genre)
par(mfrow = c(1,1))
```

*** =sample_code
```{r, eval=FALSE}
# movies is pre-loaded in your workspace

# Fit a linear regression (don't change)
movies_lm <- lm(movies$rating ~ movies$votes)

# Customize scatterplot
plot(movies$votes, movies$rating)

# Customize straight line
abline(coef(movies_lm))

# Add text
xco <- 7e5
yco <- 7
```

*** =solution
```{r, eval=FALSE}
# movies is pre-loaded in your workspace

# Fit a linear regression (don't change)
movies_lm <- lm(movies$rating ~ movies$votes)

# Customize scatterplot
plot(movies$votes, movies$rating, 
     main = "Analysis of IMDb data",
     xlab = "Number of Votes", 
     ylab = "Rating",
     col = "darkorange",
     pch = 15, 
     cex = 0.7)

# Customize straight line
abline(coef(movies_lm), lwd = 2, col = "red")

# Add text
xco <- 7e5
yco <- 7
text(xco, yco, label = "More votes? Higher rating!")
```

*** =sct
```{r, eval=FALSE}
test_error()
msg <- "Do not overwrite the <code>movies</code> data frame; it has already been created for you!"
test_object("movies", undefined_msg = msg, incorrect_msg = msg)
msg1 <- "Do not change how <code>movies_lm</code> is calculated!"
test_object("movies_lm", undefined_msg = msg1, incorrect_msg = msg1)

test_function("plot", c("x","y"))
test_function("plot", c("main"))
test_function("plot", c("xlab"))
test_function("plot", c("ylab"))
test_function("plot", c("col"))
test_function("plot", c("pch"))
test_function("plot", c("cex"))
test_function("plot", c("x","y", "main", "xlab", "ylab", "col", "pch", "cex"))

test_function("abline", "lwd")
test_function("abline", "col")
test_function("abline", c("lwd","col"))

msg2 <- "Don't change the variables <code>xco</code> and <code>yco</code>."
test_object("xco", undefined_msg = msg2, incorrect_msg = msg2)
test_object("yco", undefined_msg = msg2, incorrect_msg = msg2)

test_function("text", c("x"))
test_function("text", c("labels"))
test_function("text", c("x", "labels"))

success_msg("Awesome! This is a plot that would fit right into one of IMDb's reports, if you ask me! Head over the final exercise of this introduction to R course!")
```

*** =skills
1

--- type:MultipleChoiceExercise xp:100
## Multiple plots with different layers

The previous exercises taught you how to make multiple plots in the same graphical window as well as to add more layers to the same plot. 

Let's change roles this time. You're given a description of a graphic, and three code chunks. Only one of those code chunks produces the described graphic. Can you tell which one? The `salaries` dataset which you already encountered in previous challenges is loaded again, so you can experiment with the code. Simply make sure to run the entire chunks of code all at once.

Which one of the code chunks gives you the following three subplots on a grid of 1 rows and 3 column?
- The first plot is a scatterplot of experience versus salary (green points) with a red linear regression line. The x-axis is labeled "Experience" and the y-axis is titled "Salary".
- The second plot is a blue histogram of the `salary` variable. The x-axis should be labelled "Salary".
- The third plot displays a boxplot for salary versus each level of the degree variable. The x-axis should be called "Level of degree", whereas the y-axis should be named "Salary". 

```{r, eval = FALSE}
# OPTION A
par(mfrow = c(1,3))
plot(salaries$degree, salaries$salary, 
     xlab = "Level of degree", ylab = "Salary")
coef_lm <- coef(lm(salaries$salary ~ salaries$experience))
abline(coef_lm, col = "red")
hist(salaries$salary, col = "blue", xlab = "Salary")
plot(salaries$experience, salaries$salary, 
     col="green", xlab = "Experience", ylab = "Salary")

# OPTION B
par(mfrow = c(1,3))
plot(salaries$experience, salaries$salary, 
     col="green", xlab = "Experience", ylab = "Salary")
coef_lm <- coef(lm(salaries$salary ~ salaries$experience))
abline(coef_lm, col = "red")
hist(salaries$salary, col = "blue", xlab = "Salary")
plot(salaries$degree, salaries$salary, 
     xlab="Level of degree", ylab = "Salary")

# OPTION C
par(mfrow = c(3,1))
plot(salaries$experience, salaries$salary,
     col="green",xlab="Experience",ylab="Salary")
coef_lm <- coef(lm(salaries$salary~salaries$experience))
abline(coef_lm,col="red")
hist(salaries$salary, col="blue", xlab = "Salary")
plot(salaries$degree, salaries$salary,
     xlab = "Level of degree", ylab = "Salary")
```

*** =instructions
- A
- B
- C

*** =hint
If you want your code to appear in 1 row and 3 columns; the `mfrow` parameter should be set to `c(1,3)`.

*** =pre_exercise_code
```{r eval=FALSE}
salaries<-read.table("http://s3.amazonaws.com/assets.datacamp.com/course/introduction_to_r/salaries.txt",header=T)
salaries<-salaries[,-4]
salaries$degree <- factor(salaries$degree)
salaries
```

*** =sct
```{r eval=FALSE}
msg1 <- "The first chunck of code does not give you the wanted result. The relationship between salary and degree is depicted first instead of last. Also, the linear regression line is drawn in the wrong figure."
msg2 <- "Great! the code chunck gives the result you wanted. What a nice set of graphs!"
msg3 <- "You have been mislead! Everything in the code seems correct. But look at the first line of code again. Did we want our plots to appear in 3 rows and 1 column?"
test_mc(2, feedback_msgs = c(msg1, msg2, msg3))
```

*** =skills
1

